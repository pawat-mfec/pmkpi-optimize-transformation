
{{ config(materialized='table') }}


  SELECT
    notification_int,
    workorder_int,
    sapclient,
    notification,
    notificationdesc,
    notificationtype,
    notificationtypedesc,
    workorder,
    workorderdesc,
    notiffunctionallocation,
    notifplannergroup,
    notifplannergroupdesc,
    notifmainworkcenter,
    notifmainworkcenterdesc,
    notifrequiredstartdate,
    notifrequiredenddate,
    notifprioritycode,
    notifpriority,
    notifworkcenter,
    notifworkcenterdesc,
    notifabc_indicator,
    notifcreatedbyname,
    notifcreateddate,
    ordertype,
    ordertypedesc,
    woplannergroup,
    woplannergroupdesc,
    womainworkcenter,
    womainworkcenterdesc,
    wofunctionallocation,
    wofunctionallocationdesc,
    woequipmenttechid,
    woactualstartdate,
    woactualfinishdate,
    wocreatedbyname,
    wotecodate,
    wopriority,
    woprioritycode,
    notiffunctionallocationdesc,
    ldddate,
    wocount,
    snapshotdatetime,
    ustatuspendwordate,
    ustatusengrreviewreqdate,
    ustatuspendwopdate,
    ustatuspendstrdate,
    ustatuspendterdate,
    ustatuspendspfdate,
    ustatuspendcerdate,
    wocreateddatetime,
    notifstatus,
    NotifState,
    wophase,
    wostatus,
    woustatus,
    woscheduledstartdatetime,
    woscheduledfinishdatetime,
    wostatusconfirmeddate,
    ustatuspendsowdate,
    ustatuspenddirectpurchdelivdate,
    ustatuspendschedulingdate,
    ustatuspendbid_contractrdate,
    ustatuspendstockdeliverydate,
    notifstatusapprovalokdate,
    operationactivity,
    operationshorttext,
    criticality,
    criticalitydesc,
    CurrentFlag,
    CurrentDate,
    snapshotDate,
    wocreateddate,
    woscheduledstartdate,
    woscheduledfinishdate,
    WOandNotif,
    NotifWOFunctionalLocation,
    NotifWOFunctionalLocationDesc,
    WOandNotifRefDate,
    MainWorkCenter,
    Priority,
    notifPlatform,
    WOPlatform,
    Platform,
    DaysTillRED,
    DaysTillLDD,
    DaysLDDTillWOTECO,
    WO_Aging_KPI2a,
    WO_Aging_KPI2b,
    WO_Aging_KPI2c,
    WO_Aging_KPI3a,
    WO_Aging_KPI3b,
    WO_Aging_KPI4a,
    WO_Aging_KPI5a,
    WO_Aging_KPI5b,
    Notif_Aging_KPI1a,
    Notif_Aging_KPI1b,
    Notif_Aging_KPI5c,
    WO_Aging_KPI2b_1,
    WO_Aging_KPI2b_2,
    WO_Aging_KPI2b_3,
    WO_Aging_KPI2b_4,
    WO_Aging_KPI2b_5,
    WO_Aging_KPI2b_6,
    WO_Aging_KPI2b_7,
    Hub,
    notifHub,
    WOHub,
    WOBlock,
    notifPlannerGroup_Desc,
    WOPlannerGroup_Desc,
    notifMainWorkCenter_Desc,
    woMainWorkCenter_Desc,
    Criticality_Desc,
    sceNotification,
    SCE_WorkOrder,
    WOPhase2,
    NotifStatusColor,
    NotifWOCancelStatus,
    NotifDaysToLDDShort,
    WODaysToLDD,
    WODaysOverLDD,
    WODaysOverLDD_date,
    WOTECODateOverLDD_date,
    WODueDateComp,
    WODueDateComp_Desc,
    woroom,
    MDDDate,
    DaysTillMDD,
    DaysMDDTillWOTECO,
    WODaysOverMDD_date,
    WODaysToMDD,
    WODaysOverMDD,
    WOTECODateOverMDD_date,
    WODueDateCompMDD,
    WODueDateCompMDD_Desc
  FROM
    {{ ref('tbl_pm_kpi_view') }}
  WHERE
    --  CurrentFlag = 0 AND snapshotweekday = 4
    CurrentFlag = 0 AND EXTRACT(DAY FROM snapshotDate) = 5
    AND 1 = (
    SELECT MIN(1) DUMMY
  FROM
    `demo_dbt.pm_kpi_wo_notif_and_oper_historical`
    LIMIT 1 )

