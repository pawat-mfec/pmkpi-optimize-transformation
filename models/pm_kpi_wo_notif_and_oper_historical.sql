{{ config(materialized='incremental',
pre_hook='DELETE FROM `gcp-my-th-it-dev.uz_transform_pmkpi.pm_kpi_wo_notif_and_oper_historical` WHERE snapshotdate = (SELECT MAX(snapshotdate) FROM `gcp-my-th-it-dev.uz_transform_pmkpi.pm_kpi_wo_notif_and_oper_current_view`)') }}

SELECT
    notification_int,
    workorder_int,
    snapshotdate,
    snapshotdatetime,
    sapclient,
    notificationkey,
    workorderkey,
    notification,
    notificationdesc,
    notificationtype,
    notificationtypedesc,
    workorder,
    workorderdesc,
    notiffunctionallocation,
    notifequipmentnum,
    notifassembly,
    notifassemblydesc,
    notifcoding,
    notifcodegroup,
    notifplannergroup,
    notifplannergroupdesc,
    notifplanningplant,
    notifplanningplantdesc,
    notifmainworkcenter,
    notifmainworkcenterdesc,
    notifrequiredstartdate,
    notifrequiredenddate,
    notifprioritycode,
    notifpriority,
    notifrevision,
    notifbreakdown,
    notifmalfunctionstartdate,
    notifmalfunctionenddate,
    notifbreakdowndurationunit,
    notifmaintenanceplant,
    notifmaintenanceplantdesc,
    notiflocation,
    notifroom,
    notifplantsection,
    notifworkcenter,
    notifworkcenterdesc,
    notifabc_indicator,
    notifsortfield,
    notifcompanycodekey,
    notifcompanycode,
    notifasset,
    notifbusinessarea,
    notifcostcenter,
    notifcostcenterkey,
    notifcostcenterdesc,
    notifcontrollingarea,
    notifwbs_element,
    notifwbs_elementdesc,
    notifsettlementorder,
    notifreportedby,
    notificationdate,
    notificationtime_str,
    notificationtime,
    notifcompletiondate,
    notifreferencedate,
    notiftechinspectionby,
    notiftechinspectiondate,
    notifcreatedbyuid,
    notifcreatedbyname,
    notifcreateddate,
    notifstatusoutstandingnotification,
    notifstatusnotificationpostponed,
    notifstatusnotificationinprocess,
    notifstatusorderassigned,
    notifstatusnotificationcompleted,
    notifstatusdeletionflag,
    notifstatusapprovalrefused,
    notifstatusothers,
    notifstaterejected,
    notifstatependingapproval,
    notifstatependingworkordercreation,
    notifstatependingclose,
    notifstatecompleted,
    notifstatedeletionflag,
    notifstatusapprovalrequired,
    notifstatusapprovalok,
    notifstatusapprovalrequireddate,
    notifstatusapprovalokdate,
    notifstatusoutstandingnotificationdate,
    notifstatusnotificationpostponeddate,
    notifstatusnotificationinprocessdate,
    notifstatusorderassigneddate,
    notifstatusnotificationcompleteddate,
    notifstatusdeletionflagdate,
    notifstatusapprovalrefuseddate,
    ordertype,
    ordertypedesc,
    woplannergroup,
    woplannergroupdesc,
    woplanningplant,
    woplanningplantdesc,
    womainworkcenter,
    womainworkcenterdesc,
    womaintenanceactivitytype,
    womaintenanceactivitytypedesc,
    wobasicstartdate,
    wobasicfinishdate,
    woscheduledstartdate,
    woscheduledfinishdate,
    worevision,
    woreferencedate,
    wofunctionallocation,
    wofunctionallocationdesc,
    woequipmentnum,
    woequipmentdesc,
    woequipmenttechid,
    woassembly,
    woassemblydesc,
    wocompanycodekey,
    wocompanycode,
    wocompanycodedesc,
    wobusinessarea,
    wocontrollingarea,
    woprofitcenter,
    woprofitcenterdesc,
    wofunctionalarea,
    wofunctionalareadesc,
    womaintenanceplant,
    womaintenanceplantdesc,
    wolocation,
    woroom,
    woplantsection,
    wowbs_element,
    wowbs_elementdesc,
    woemergencyind,
    woplanningindicator,
    woreleasedate,
    woclosedate,
    wophaseordercreated,
    wophaseorderreleased,
    wophaseordercompleted,
    wophaseorderclosed,
    wophaseorderexecutedpendingcompletion,
    woactualstartdate,
    woactualfinishdate,
    worespcostcenter,
    wocreateddate,
    wocreatedbyuid,
    wocreatedbyname,
    wochangeddate,
    wochangedbyuid,
    wochangedbyname,
    wotecodate,
    wocostcenterhierarchy,
    wocostcenterkey,
    wocostcenter,
    wocostcenterdesc,
    wostatusclosed,
    wostatusconfirmed,
    wostatuscreated,
    wostatusdeletionflag,
    wostatusnotcompleted,
    wostatusreleased,
    wostatusreleaserejected,
    wostatustechnicallycompleted,
    wopriority,
    woprioritycode,
    woobjectlist,
    ordercurrency,
    workorderindicator,
    notificationindicator,
    notiffunctionallocationdesc,
    notifequipmentdesc,
    odddate,
    ustatusafereviewreq,
    ustatusengrreviewreq,
    ustatusmocreviewreq,
    ustatuscancelled,
    ustatuspendmmcreation,
    ustatuspendsow,
    ustatusreplan,
    ustatuspendsupapproval,
    ustatuspenddoccloseout,
    ustatuspendextservices,
    ustatuspendintexecution,
    ustatuspendplanning,
    ustatuspenddirectpurchdeliv,
    ustatuspendscheduling,
    ustatuspendstockreplen,
    ustatuspendbid_contractr,
    ustatuspendstockdelivery,
    ustatusinprocessing,
    ustatusinitial,
    ustatushold,
    ustatuscompleted,
    ldddate,
    woscheduledstarttime,
    woscheduledfinishtime,
    wocreatedtime,
    wostatuspartiallyconfirmed,
    woustatusprofile,
    wostatuspartiallyconfirmeddate,
    wostatusconfirmeddate,
    wostatusdeletionflagdate,
    wostatusnotcompleteddate,
    wostatusreleaserejecteddate,
    ustatusafereviewreqdate,
    ustatusengrreviewreqdate,
    ustatusmocreviewreqdate,
    ustatuscancelleddate,
    ustatuspendmmcreationdate,
    ustatuspendsowdate,
    ustatusreplandate,
    ustatuspendsupapprovaldate,
    ustatuspenddoccloseoutdate,
    ustatuspendextservicesdate,
    ustatuspendintexecutiondate,
    ustatuspendplanningdate,
    ustatuspenddirectpurchdelivdate,
    ustatuspendschedulingdate,
    ustatuspendstockreplendate,
    ustatuspendbid_contractrdate,
    ustatuspendstockdeliverydate,
    ustatusinprocessingdate,
    ustatusinitialdate,
    ustatusholddate,
    ustatuscompleteddate,
    ustatusschdaip,
    ustatuspendwor,
    ustatuspendwop,
    ustatuspendstr,
    ustatuspendter,
    ustatuspendspf,
    ustatuspendcer,
    ustatusschdaipdate,
    ustatuspendwordate,
    ustatuspendwopdate,
    ustatuspendstrdate,
    ustatuspendterdate,
    ustatuspendspfdate,
    ustatuspendcerdate,
    notificationcount,
    breakdowndurationhrs,
    notifnumberofprocessingdays,
    notifpendingapprovalagingdays,
    notifpendingcloseagingdays,
    wocount,
    estimatedcostordercur,
    estimatedcostusd,
    plannedcostordercur,
    plannedcostusd,
    actualcostordercur,
    actualcostusd,
    wopendingreleaseaging,
    wopendingtecoaging,
    notiftowocreationdays,
    woobjectlistcount,
    notificationdatetime,
    wocreateddatetime,
    woscheduledstartdatetime,
    woscheduledfinishdatetime,
    notifstatus,
    notifstate,
    wophase,
    wostatus,
    woustatus ,
    notifplatform,
    woplatform,

    wonumber
    ,operationactivity
    ,operationshorttext
    ,criticality
    ,performancestandard
    ,classtype
    ,characteristicvalue
    ,class
    ,classtypedesc
    ,classdesc
    ,characteristic
    ,womaintenanceitem
    ,womaintenanceplan
    ,characteristicdesc
    ,characteristicvaluedesc
    ,criticalitydesc
    ,wotltype
    ,wotlgroup
    ,wotlgroupcounter
    ,woroom_oper
    ,wo_notif_flag

FROM `gcp-my-th-it-dev.uz_transform_pmkpi.pm_kpi_wo_notif_and_oper_current_view`
